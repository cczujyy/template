<!DOCTYPE html>
{% load static %}
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <script
      src="https://kit.fontawesome.com/64d58efce2.js"
      crossorigin="anonymous"
    ></script>
    <link rel="stylesheet" href="{% static 'myadmin/index/style.css' %}" />
    <title>登录 & 注册</title>
  </head>
  <body>
    <div class="container">
      <div class="forms-container">
        <div class="signin-signup">
          <form action="{% url 'myadmin_login' %}" method="post" class="sign-in-form">
            {% csrf_token %}
            <h2 class="title">登录</h2>

            <font color="red"> {{ info }}</font>
            <div class="input-field">
              <i class="fas fa-user"></i>
              <input type="text" name="username" placeholder="用户名" />
            </div>
            <div class="input-field">
              <i class="fas fa-lock"></i>
              <input type="password" name="password" placeholder="密码" />
            </div>
            <input type="submit" value="登录" class="btn solid" />
            <p class="social-text">Copyright @ Wuliang2021</p>
            <div class="social-media">

            </div>
          </form>
          <form action="{% url 'myadmin_login' %}" method="post" class="sign-up-form" id="regist">
            {% csrf_token %}
            <h2 class="title">注册</h2>
            <font color="red">{{ registinfo }}</font>
            <div class="input-field">
              <i class="fas fa-user"></i>
              <input type="text" id="username" name="username" placeholder="用户名" />
            </div>
            <div class="input-field">
              <i class="fas fa-envelope"></i>
              <input type="email" name="email" placeholder="电子邮件" />
            </div>
            <div class="input-field">
              <i class="fas fa-envelope"></i>
              <input type="text" name='phonenumber' id="phonenumber" placeholder="手机" />
            </div>
            <div class="input-field">
              <i class="fas fa-lock"></i>
              <input type="text" name="school" placeholder="学校" />
            </div>
            <div class="input-field">
              <i class="fas fa-lock"></i>
              <input type="text" name="number" placeholder="学号" />
            </div>
            <div class="input-field">
              <i class="fas fa-lock"></i>
              <input type="password" id="password" name="password" placeholder="密码" />
            </div>
            <div class="input-field">
              <i class="fas fa-lock"></i>
              <input type="password" id="confirmpassword" placeholder="确认密码" />
            </div>
            <button class="btn" type="button" id="kkk" onclick="Regisitspt();">注册</button>
            <p class="social-text">Copyright @ Wuliang2021</p>
            <div class="social-media">





              <script>
                function Regisitspt() {
                    var username = document.getElementById("username").value;
                    var phonenumber = document.getElementById("phonenumber").value;
                    var password = document.getElementById("password").value;
                    var confirmpassword = document.getElementById("confirmpassword").value;
                    var regex = new RegExp('^(?![0-9]+$)(?![a-zA-Z]+$)[0-9A-Za-z]{8,20}$');
                    var regex1 = new RegExp('^1[3|4|5|6|8|9][0-9]\\d{8}$');
                    if (username == "" || password == "" || phonenumber == ""){
                        alert("用户名、手机或密码不能为空");
                        return;
                    }
                    if (password != confirmpassword){
                        alert("密码不一致");
                        return;
                    }
                    if (!regex1.test(phonenumber)){
                        alert("请输入正确的手机号");
                        return;
                    }
                    if (!regex.test(password)){
                        alert("密码必须大于8位且包含有数字、字母");
                        return;
                    }
                    document.getElementById("kkk").disabled=true;
                    //调用后端
                    document.getElementById("regist").submit();

                }
            </script>

            </div>
          </form>
        </div>
      </div>

      <div class="panels-container">
        <div class="panel left-panel">
          <div class="content">
            <h3>静听（测试名）</h3>
            <p align="left">
              测试版本beta1.0.0 用户须知<br/>
              1.本产品使用测试阶段，邀请广大用户共同开发，开放源代码和架构，需要的联系站主<br/>
              *2.本产品测试阶段密码将不会采用加密手段，即存放在数据库的密码均为原生密码，所以不建议使用个人常用密码<br/>
              3.忘记密码可联系站主找回或者重新创建账号<br/>
              4.产品网址可能涉及相关法律问题，不做商业用途，涉嫌版权问题，请联系站主进行沟通<br/>
              5.用户注册即代表同意上述条款<br/>
            </p>
            <button class="btn transparent" id="sign-up-btn">
              注册
            </button>
          </div>
          <img src="{% static 'myadmin/index/img/log.svg'%}" class="image" alt="" />
        </div>
        <div class="panel right-panel">
          <div class="content">
            <h3>静听（测试名）</h3>
            <p align="left">
              测试版本beta1.0.0 用户须知<br/>
              1.本产品使用测试阶段，邀请广大用户共同开发，开放源代码和架构，需要的联系站主<br/>
              *2.本产品测试阶段密码将不会采用加密手段，即存放在数据库的密码均为原生密码，所以不建议使用个人常用密码<br/>
              3.忘记密码可联系站主找回或者重新创建账号<br/>
              4.产品网址可能涉及相关法律问题，不做商业用途，涉嫌版权问题，请联系站主进行沟通<br/>
              5.用户注册即代表同意上述条款<br/>
            </p>
            <button class="btn transparent" id="sign-in-btn">
              登录
            </button>
          </div>
          <img src="{% static 'myadmin/index/img/register.svg'%}" class="image" alt="" />
        </div>
      </div>
    </div>


    {% if registinfo != none %}
      <script>
        const sign_in_btn1 = document.querySelector("#sign-in-btn");
        const sign_up_btn1 = document.querySelector("#sign-up-btn");
        const container1 = document.querySelector(".container");
        container1.classList.add("sign-up-mode");
      </script>
    {% endif %}
    <script src="{% static 'myadmin/index/app.js' %}"></script>
  </body>
</html>
